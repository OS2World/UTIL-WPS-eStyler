<html>
<head>
   <title>SHUTDOWN.EXE - Выключение из командной строки</title>
</head>
<body>

<br>
Чтобы позволить пользователю получить доступ ко всем расширенным функциям
завершения работы, даже если система должна быть закрыта через командную
строку или с помощью командного файла, предоставляется
<b>расширенная версия SHUTDOWN.EXE</b>.
<p>
<b>Синтаксис команды</b> довольно простой:
<pre>
SHUTDOWN [команда] [параметры]
</pre>
<b>Примечание:</b><br>
Все команды и параметры нечувствительны к регистру и могут начинаться с
тире (<tt>-</tt>), косой черты (<tt>/</tt>) или могут вводиться без какого-либо
префикса. Учитывается только первая буква.<br>
SHUTDOWN.EXE, выполняемый без параметров, выполняет обычное завершение работы
(эквивалент команды 'C' - смотрите ниже).
<p>
Допустимые <b>команды</b>:
<pre>
[ [ / | - ] ? | D | L | S | C | O | R [:ItemIndex | VolName ] ]
</pre>
<dl nobreak>
<dt><b>?</b> или <b>H</b></dt>
<dd>показать экспресс экран справки</dd>
<dt><b>D</b></dt>
<dd>показать диалоговое окно выключения, чтобы позволить пользователю выбрать,
какой тип выключения должен быть применён.</dd>
<dt><b>L</b></dt>
<dd>заблокировать рабочий стол и перевести систему в ждущий режим</dd>
<dt><b>S</b></dt>
<dd>перевести систему в ждущий режим</dd>
<dt><b>C</b></dt>
<dd>закрыть систему (компьютер необходимо выключить или перезагрузить вручную)</dd>
<dt><b>O</b></dt>
<dd>отключить питание системы</dd>
<dt><b>R</b></dt>
<dd>перезагрузить с текущего тома.<br>
Если за ним следует <b>:n</b>, то система загрузится с n-ного тома (начиная с 0,
как указано в списке перезагрузки).<br>
Если за ним следует имя тома, перезагрузка происходит с этого тома.</dd>
</dl>
<b>Параметры</b> работают только с командами <b>C</b>, <b>O</b> или <b>R</b>.
Допустимые параметры:
<pre>
[ [ / | - ] E | N ]
</pre>
<dl nobreak>
<dt><b>E</b></dt>
<dd>выполнить программы выключения, определённые в блокноте настроек выключения.
</dd>
<dt><b>N</b></dt>
<dd>не выполнять программы выключения</dd>
<dt><b>без параметров</b></dt>
<dd>это касается текущих настроек выключения по умолчанию</dd>
</dl>
<b>Примеры:</b>
<p>
<tt>SHUTDOWN /RWIN2000 /N</tt><br>
<tt>SHUTDWON -rWIN2000 -n</tt><br>
<tt>SHUTDOWN rWIN2000 n</tt><br>
<ul compact>
перезагружает, используя для загрузки том с именем "WIN2000" без выполнения
программ выключения.
</ul>
<br>
<tt>SHUTDOWN -r:0 -e</tt>
<ul compact>
перезагружает с первого тома в списке томов для перезагрузки и запускает
программы выключения (если в списке есть какая-либо программа).
</ul>
<p>
<b>Возвращаемые значения:</b>
<dl nobreak>
<dt>0</dt><dd>успешное выполнение.</dd>
<dt>2</dt><dd>ошибка: не удалось получить дескриптор окна объекта Styler.</dd>
<dt>4</dt><dd>ошибка: неправильные параметры.</dd>
<dt>6</dt><dd>ошибка: не удалось отправить запрос на отключение в окно объекта
Styler.</dd>
</dl>
</body>
</html>
